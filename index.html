<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Pizzería</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <link href="css/style.css" rel="stylesheet">
</head>
<body>

<div class="header">
    <h1>Bienvenido a nuestra Pizzería</h1>
</div>

<div class="container">
    <div class="category">
        <h2>Pizzas</h2>
        <div class="row">
            <div class="col-md-6 col-lg-4 product">
                <img src="https://via.placeholder.com/150" alt="Pizza Margherita">
                <h3>Pizza Margherita</h3>
                <div class="price-container">
                    <span class="old-price">$12.00</span>
                    <span class="new-price">$10.00</span>
                </div>
                <button class="btn btn-details" onclick="showDetails('Pizza Margherita', 'Deliciosa pizza con salsa de tomate, mozzarella fresca y albahaca.')">Detalles</button>
                <button class="btn" onclick="addToCart('Pizza Margherita', 10.00)">Agregar al carrito</button>
            </div>
            <div class="col-md-6 col-lg-4 product">
                <img src="https://via.placeholder.com/150" alt="Pizza Pepperoni">
                <h3>Pizza Pepperoni</h3>
                <div class="price-container">
                    <span class="old-price">$14.00</span>
                    <span class="new-price">$12.00</span>
                </div>
                <button class="btn btn-details" onclick="showDetails('Pizza Pepperoni', 'Clásica pizza con salsa de tomate, mozzarella y pepperoni.')">Detalles</button>
                <button class="btn" onclick="addToCart('Pizza Pepperoni', 12.00)">Agregar al carrito</button>
            </div>
            <div class="col-md-6 col-lg-4 product">
                <img src="https://via.placeholder.com/150" alt="Pizza Vegetariana">
                <h3>Pizza Vegetariana</h3>
                <div class="price-container">
                    <span class="old-price">$13.00</span>
                    <span class="new-price">$11.00</span>
                </div>
                <button class="btn btn-details" onclick="showDetails('Pizza Vegetariana', 'Pizza llena de vegetales frescos, mozzarella y salsa de tomate.')">Detalles</button>
                <button class="btn" onclick="addToCart('Pizza Vegetariana', 11.00)">Agregar al carrito</button>
            </div>
        </div>
    </div>

    <div class="category">
        <h2>Pastas</h2>
        <div class="row">
            <div class="col-md-6 col-lg-4 product">
                <img src="https://via.placeholder.com/150" alt="Spaghetti Carbonara">
                <h3>Spaghetti Carbonara</h3>
                <div class="price-container">
                    <span class="old-price">$11.00</span>
                    <span class="new-price">$9.00</span>
                </div>
                <button class="btn btn-details" onclick="showDetails('Spaghetti Carbonara', 'Spaghetti con salsa cremosa de huevo, queso pecorino, panceta y pimienta negra.')">Detalles</button>
                <button class="btn" onclick="addToCart('Spaghetti Carbonara', 9.00)">Agregar al carrito</button>
            </div>
            <div class="col-md-6 col-lg-4 product">
                <img src="https://via.placeholder.com/150" alt="Lasagna">
                <h3>Lasagna</h3>
                <div class="price-container">
                    <span class="old-price">$13.00</span>
                    <span class="new-price">$11.00</span>
                </div>
                <button class="btn btn-details" onclick="showDetails('Lasagna', 'Capas de pasta intercaladas con salsa boloñesa, bechamel y queso gratinado.')">Detalles</button>
                <button class="btn" onclick="addToCart('Lasagna', 11.00)">Agregar al carrito</button>
            </div>
            <div class="col-md-6 col-lg-4 product">
                <img src="https://via.placeholder.com/150" alt="Fettuccine Alfredo">
                <h3>Fettuccine Alfredo</h3>
                <div class="price-container">
                    <span class="old-price">$12.00</span>
                    <span class="new-price">$10.00</span>
                </div>
                <button class="btn btn-details" onclick="showDetails('Fettuccine Alfredo', 'Pasta fettuccine en una cremosa salsa de queso parmesano y mantequilla.')">Detalles</button>
                <button class="btn" onclick="addToCart('Fettuccine Alfredo', 10.00)">Agregar al carrito</button>
            </div>
        </div>
    </div>

    <div class="category">
        <h2>Bebidas</h2>
        <div class="row">
            <div class="col-md-6 col-lg-4 product">
                <img src="https://via.placeholder.com/150" alt="Refresco">
                <h3>Refresco</h3>
                <div class="price-container">
                    <span class="old-price">$3.00</span>
                    <span class="new-price">$2.50</span>
                </div>
                <button class="btn btn-details" onclick="showDetails('Refresco', 'Variedad de refrescos fríos.')">Detalles</button>
                <button class="btn" onclick="addToCart('Refresco', 2.50)">Agregar al carrito</button>
            </div>
            <div class="col-md-6 col-lg-4 product">
                <img src="https://via.placeholder.com/150" alt="Cerveza">
                <h3>Cerveza</h3>
                <div class="price-container">
                    <span class="old-price">$4.50</span>
                    <span class="new-price">$4.00</span>
                </div>
                <button class="btn btn-details" onclick="showDetails('Cerveza', 'Selección de cervezas artesanales e importadas.')">Detalles</button>
                <button class="btn" onclick="addToCart('Cerveza', 4.00)">Agregar al carrito</button>
            </div>
            <div class="col-md-6 col-lg-4 product">
                <img src="https://via.placeholder.com/150" alt="Vino de la Casa">
                <h3>Vino de la Casa</h3>
                <div class="price-container">
                    <span class="old-price">$6.00</span>
                    <span class="new-price">$5.00</span>
                </div>
                <button class="btn btn-details" onclick="showDetails('Vino de la Casa', 'Vino tinto o blanco de selección.')">Detalles</button>
                <button class="btn" onclick="addToCart('Vino de la Casa', 5.00)">Agregar al carrito</button>
            </div>
        </div>
    </div>
</div>

    <div class="floating-cart" onclick="viewCart()">
        <i class="bi bi-cart"></i>
        <span id="cartCount" class="cart-count">0</span>
    </div>

    <div class="modal fade" id="detailsModal" tabindex="-1" aria-labelledby="detailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="detailsModalLabel">Detalles del Producto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="modalBody">
                    ...
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal del Carrito -->
<div class="modal fade" id="cartModal" tabindex="-1" aria-labelledby="cartModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="cartModalLabel">Productos en el Carrito</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="cartModalBody">
                No hay productos en el carrito.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary" onclick="showPaymentModal()">Pagar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Pago -->
<div class="modal fade" id="paymentModal" tabindex="-1" aria-labelledby="paymentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="paymentModalLabel">Información de Pago y Entrega</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="paymentForm">
                    <div class="mb-3">
                        <label for="fullName" class="form-label">Nombre y apellidos</label>
                        <input type="text" class="form-control" id="fullName" required>
                    </div>
                    <div class="mb-3">
                        <label for="phone" class="form-label">Teléfono</label>
                        <input type="tel" class="form-control" id="phone" required>
                    </div>
                    <div class="mb-3">
                        <label for="address" class="form-label">Dirección</label>
                        <input type="text" class="form-control" id="address" required>
                    </div>
                    <div class="mb-3">
                        <label for="reference" class="form-label">Punto de referencia</label>
                        <input type="text" class="form-control" id="reference">
                    </div>
                    <div class="mb-3">
                        <p>Transfiera la cantidad de <strong id="totalAmount"></strong> a la cuenta:</p>
                        <p class="h5"><span id="accountNumber" style="cursor: pointer;">9225 9090 8776 5432
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="black" class="bi bi-copy" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1z"/>
</svg>
						
						</span></p>
                    </div>
                    <div class="mb-3">
                        <label for="transactionSMS" class="form-label">Copie y pegue el SMS de la transacción aquí:</label>
                        <input type="text" class="form-control" id="transactionSMS" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                <button type="button" class="btn btn-primary" onclick="submitOrder()">Hacer Pedido</button>
            </div>
        </div>
    </div>
</div>

<div id="notification" class="notification"></div>
<div id="loadingSpinner" class="loading-spinner">
    <div class="spinner"></div>
</div>


    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
	 let cartItems = [];

        function addToCart(product, price) {
            let existingItem = cartItems.find(item => item.name === product);
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cartItems.push({name: product, quantity: 1, price: price});
            }
            updateCartCount();
            showNotification(`${product} agregado al carrito`, 'success');
        }

        function updateCartCount() {
            let totalItems = cartItems.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = totalItems;
        }

        function showDetails(productName, productDescription) {
            document.getElementById('modalBody').innerHTML = `<strong>${productName}</strong><p>${productDescription}</p>`;
            new bootstrap.Modal(document.getElementById('detailsModal')).show();
        }

        function viewCart() {
            const cartModalBody = document.getElementById('cartModalBody');
            if (cartItems.length > 0) {
                let cartHTML = '';
                let total = 0;
                cartItems.forEach(item => {
                    let itemTotal = item.quantity * item.price;
                    total += itemTotal;
                    cartHTML += `
                        <div class="cart-item">
                            <div class="cart-item-info">
                                <strong>${item.name}</strong> - $${item.price.toFixed(2)} x ${item.quantity}
                            </div>
                            <div class="cart-item-actions">
                                <button onclick="changeQuantity('${item.name}', 1)" class="btn btn-sm btn-primary">+</button>
                                <button onclick="changeQuantity('${item.name}', -1)" class="btn btn-sm btn-danger">-</button>
                                <button onclick="removeFromCart('${item.name}')" class="btn btn-sm btn-warning">Eliminar</button>
                            </div>
                        </div>
                    `;
                });
                cartHTML += `<div class="cart-total">Total a pagar: $${total.toFixed(2)}</div>`;
                cartModalBody.innerHTML = cartHTML;
            } else {
                cartModalBody.innerHTML = 'No hay productos en el carrito.';
            }
            $('#cartModal').modal('show');
        }

        function changeQuantity(productName, change) {
            let item = cartItems.find(item => item.name === productName);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(productName);
                }
                updateCartCount();
                viewCart();
            }
        }

        function removeFromCart(productName) {
            cartItems = cartItems.filter(item => item.name !== productName);
            updateCartCount();
            viewCart();
            showNotification(`${productName} eliminado del carrito`, 'success');
        }

        function showPaymentModal() {
            $('#cartModal').modal('hide');
            let total = cartItems.reduce((sum, item) => sum + item.price * item.quantity, 0);
            document.getElementById('totalAmount').textContent = `$${total.toFixed(2)}`;
            $('#paymentModal').modal('show');
        }

        document.getElementById('accountNumber').addEventListener('click', function() {
            navigator.clipboard.writeText(this.textContent.trim()).then(() => {
                showNotification('Número de cuenta copiado al portapapeles', 'success');
            });
        });

       // Configuración de Telegram
const BOT_TOKEN = '6998902940:AAHWICrBuD2ROmUjuvd8IIHWWECv9s_-CEY';
const CHAT_ID = '-4581973425';
const TELEGRAM_API = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;

// Función para enviar mensaje a Telegram
async function sendToTelegram(message) {
    try {
        const response = await fetch(TELEGRAM_API, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                chat_id: CHAT_ID,
                text: message
            })
        });

        if (!response.ok) {
            throw new Error('Error en la respuesta de Telegram');
        }

        return true;
    } catch (error) {
        console.error('Error al enviar mensaje a Telegram:', error);
        return false;
    }
}

function showNotification(message, type) {
    const notificationDiv = document.createElement('div');
    notificationDiv.className = `notification ${type === 'success' ? 'notification-success' : 'notification-error'}`;
    notificationDiv.innerHTML = `
        ${message}
        <button class="close-btn">&times;</button>
    `;
    document.body.appendChild(notificationDiv);

    // Mostrar la notificación
    setTimeout(() => {
        notificationDiv.classList.add('show');
    }, 10);

    // Configurar el botón de cerrar
    const closeBtn = notificationDiv.querySelector('.close-btn');
    closeBtn.addEventListener('click', () => {
        notificationDiv.classList.remove('show');
        setTimeout(() => {
            notificationDiv.remove();
        }, 300);
    });

    // Eliminar la notificación después de 5 segundos
    setTimeout(() => {
        notificationDiv.classList.remove('show');
        setTimeout(() => {
            notificationDiv.remove();
        }, 300);
    }, 5000);
}

// Función para mostrar/ocultar el spinner
function toggleSpinner(show) {
    const spinner = document.getElementById('loadingSpinner');
    spinner.style.display = show ? 'flex' : 'none';
}

// Función modificada para enviar el pedido
async function submitOrder() {
    if (document.getElementById('paymentForm').checkValidity()) {
        toggleSpinner(true); // Mostrar el spinner

        const fullName = document.getElementById('fullName').value;
        const phone = document.getElementById('phone').value;
        const address = document.getElementById('address').value;
        const reference = document.getElementById('reference').value;
        const transactionSMS = document.getElementById('transactionSMS').value;

        let orderDetails = `🛒 NUEVO PEDIDO\n\n`;
        orderDetails += `👤 Nombre: #${fullName}\n`;
        orderDetails += `📞 Teléfono: ${phone}\n`;
        orderDetails += `🏠 Dirección: ${address}\n`;
        orderDetails += `🚩 Punto de referencia: ${reference}\n`;
        orderDetails += `💳 SMS de transacción: ${transactionSMS}\n\n`;
        orderDetails += `📦 Productos:\n`;

        let total = 0;
        cartItems.forEach(item => {
            const itemTotal = item.price * item.quantity;
            total += itemTotal;
            orderDetails += `- ${item.name} - $${item.price.toFixed(2)} x ${item.quantity} = $${itemTotal.toFixed(2)}\n`;
        });

        orderDetails += `\n💰 Total a pagar: $${total.toFixed(2)}`;

        try {
            const success = await sendToTelegram(orderDetails);

            if (success) {
                showNotification('¡Pedido realizado con éxito!', 'success');
                $('#paymentModal').modal('hide');
                cartItems = [];
                updateCartCount();
            } else {
                showNotification('Error al enviar el pedido. Por favor, inténtelo de nuevo.', 'error');
            }
        } catch (error) {
            showNotification('Error al enviar el pedido. Por favor, inténtelo de nuevo.', 'error');
        } finally {
            toggleSpinner(false); // Ocultar el spinner
        }
    } else {
        showNotification('Por favor, complete todos los campos requeridos.', 'error');
    }
}
	
	
	</script>
</body>
</html>